@model Cloud_Assignment.Models.DistributionSchedule
@using Cloud_Assignment.Areas.Identity.Data
@using Microsoft.AspNetCore.Identity
@inject UserManager<Cloud_AssignmentUser> UserManager
@{
    var UserAccount = await UserManager.GetUserAsync(User);
}

<button onclick="Back()">Back</button>
<center>
    <h1>Edit Distribution Schedule:</h1>
    <br/><hr/><br/>
    <form method="post" asp-action="UpdateDistributionRecord" asp-controller="DistributionScheduleRecord">
        <table border='1'>
            <tr>
                <th><label asp-for="DistributionId"></label></th>
                <td><input asp-for="DistributionId" readonly /></td>
                <td><span asp-validation-for="DistributionId"></span></td>
            </tr>
            <tr>
                <th><label asp-for="RecordType"></label></th>
                <td><input asp-for="RecordType" readonly /></td>
                <td><span asp-validation-for="RecordType"></span></td>
            </tr>
            <tr>
                <th><label asp-for="RecordId"></label></th>
                <td><input asp-for="RecordId" /></td>
                <td><span asp-validation-for="RecordId"></span></td>
            </tr>
            <tr>
                <th><label asp-for="DistributionStatus"></label></th>
                <td><select asp-for="DistributionStatus" id="distributionstatus">
                        <option value="Pending" >Pending</option>
                        <option value="Deliverd" >Deliverd</option>
                    </select>
                </td>
                <td><span asp-validation-for="DistributionStatus"></span></td>
            </tr>
            <tr>
                <th><label asp-for="DOD"></label></th>
                <td><input asp-for="DOD" /></td>
                <td><span asp-validation-for="DOD"></span></td>
            </tr>
            <tr>
                <input name="DistributorId" value="@UserAccount?.Id" hidden />
            </tr>
            <tr>
                <td colspan="3" style="text-align:center">
                    <button type="submit" class="btn-info">
                        Update Schedule
                    </button>
                </td>
            </tr>
        </table>
    </form>
</center>

<script>
    function Back() {
        var previousPage = '@(Context.Request.Headers["Referer"].ToString())';
        window.location.href = previousPage;
    }

    var isDeliverd = true;
    var dropdown = document.getElementById("distributionstatus");
    if (@Model.DistributionStatus == "Pending") {
        var isDeliverd = false;
    }
    if (isDeliverd) {
        dropdown.value = "Deliverd";
    } else {
        dropdown.ariaValueMax = "Pending";
    }
</script>